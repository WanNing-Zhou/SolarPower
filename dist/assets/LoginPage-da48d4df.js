import{d as I,r as p,w as S,c as C,a,u as L,b as t,o as U,e,f,g as c,s as q,E as m,p as B,h as E,_ as N}from"./index-885010f6.js";import{l as P,g as M}from"./user-6c997152.js";const R=n=>(B("data-v-0130d768"),n=n(),E(),n),T=R(()=>f("h1",null,"登录",-1)),$={class:"flex"},z=I({__name:"LoginPage",setup(n){const g=p(!1),r=p({username:"",password:"",repassword:""}),_=p(),w={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{pattern:/^\S{5,15}$/,message:"密码必须是5-15位的非空字符",trigger:"blur"}],repassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{pattern:/^\S{5,15}$/,message:"密码必须是5-15位的非空字符",trigger:"blur"},{validator:(l,s)=>{l!==r.value.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]},i=L(),v=async()=>{var l;try{await _.value.validate();const s=await P({username:r.value.username,password:r.value.password});s.data&&q(s.data);const o=await M();console.log(o);const{isAdmin:u}=(l=o==null?void 0:o.data)==null?void 0:l.permission;u?i.push("/admin"):i.push("/home"),m.success("登录成功")}catch(s){m.error(s)}};return S(g,()=>{r.value={username:"",password:"",repassword:""}}),(l,s)=>{const o=t("el-form-item"),u=t("el-input"),h=t("el-checkbox"),x=t("el-link"),b=t("el-button"),y=t("el-form"),k=t("el-col"),V=t("el-row");return U(),C(V,{class:"login-page"},{default:a(()=>[e(k,{span:24,class:"form"},{default:a(()=>[e(y,{ref_key:"form",ref:_,model:r.value,rules:w,size:"large",autocomplete:"off",style:{width:"30%"}},{default:a(()=>[e(o,null,{default:a(()=>[T]),_:1}),e(o,{prop:"username"},{default:a(()=>[e(u,{"prefix-icon":"User",modelValue:r.value.username,"onUpdate:modelValue":s[0]||(s[0]=d=>r.value.username=d),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(o,{prop:"password"},{default:a(()=>[e(u,{name:"password","prefix-icon":"Lock",type:"password",modelValue:r.value.password,"onUpdate:modelValue":s[1]||(s[1]=d=>r.value.password=d),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(o,{class:"flex"},{default:a(()=>[f("div",$,[e(h,null,{default:a(()=>[c("记住我")]),_:1}),e(x,{type:"primary",underline:!1},{default:a(()=>[c("忘记密码？")]),_:1})])]),_:1}),e(o,null,{default:a(()=>[e(b,{class:"button",type:"primary",onClick:v,"auto-insert-space":""},{default:a(()=>[c("登录")]),_:1})]),_:1}),e(o,{class:"flex"})]),_:1},8,["model"])]),_:1})]),_:1})}}});const D=N(z,[["__scopeId","data-v-0130d768"]]);export{D as default};
