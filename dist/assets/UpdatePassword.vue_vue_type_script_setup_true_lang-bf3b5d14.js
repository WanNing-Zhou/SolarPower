import{u as x,a as k}from"./user-d97a62ac.js";import{y as U,z as B,E as u,d as C,A as N,r as _,n as R,c as h,a as t,u as E,b as d,e as T,f as o,h as z,g as A}from"./index-313e5491.js";async function H(){(await x()).code==200&&(U.push("/login"),B(),u.success("登出成功"))}const j=C({__name:"UpdatePassword",props:{visible:{type:Boolean}},emits:["update:visible"],setup(i,{emit:v}){const P=i,p=v,g=E(),V=N({oldPassword:[{min:6,max:32,message:"密码长度应在6-32间"}],newPassword:[{min:6,max:32,message:"密码长度应在6-32间"}],rePassword:[{min:6,max:32,message:"密码长度应在6-32间"}]}),w=_(),c=R({get(){return P.visible},set(n){p("update:visible",n)}}),s=_({oldPassword:"",newPassword:"",rePassword:""}),b=async()=>{var n;(n=w.value)==null||n.validate(async e=>{if(e){const{oldPassword:r,newPassword:a,rePassword:m}=s.value;if(!a||!r){u.warning("密码不能为空");return}if(a!=m){u.warning("新密码两次输入不一致");return}(await k({oldPassword:r,newPassword:a})).code==200&&(u.success("修改成功"),H(),g.push("/login"),p("update:visible",!1))}else u.warning("表单校验失败, 请检查表单")})};return(n,e)=>{const r=d("el-input"),a=d("el-form-item"),m=d("el-form"),f=d("el-button"),y=d("el-dialog");return T(),h(y,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),title:"修改密码",width:"500"},{footer:t(()=>[o(f,{onClick:b,type:"primary"},{default:t(()=>[z("提交")]),_:1})]),default:t(()=>[A("div",null,[o(m,{ref_key:"formRef",ref:w,model:s.value,rules:V,"label-width":"120"},{default:t(()=>[o(a,{prop:"oldPassword",label:"旧密码"},{default:t(()=>[o(r,{modelValue:s.value.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.oldPassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1}),o(a,{prop:"newPassword",label:"新密码"},{default:t(()=>[o(r,{modelValue:s.value.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.newPassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1}),o(a,{prop:"rePassword",label:"确认密码"},{default:t(()=>[o(r,{modelValue:s.value.rePassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.rePassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}}});export{j as _,H as l};
