import{d as h,r as w,n as k,w as x,c as B,a as t,b as c,e as D,g as y,v as $,f as e,h as v,E as V,A as H,j as N,u as S}from"./index-614b9659.js";import{i as j,j as z,g as T,k as A}from"./suer-4e70a082.js";const F={class:"my-header"},M=h({__name:"CompanyEditDialog",props:{visible:{type:Boolean},company:{}},emits:["update:visible","success"],setup(C,{emit:_}){const i=C,o=_,b={name:"",address:"",manager:"",contact:""},a=w({...b}),m=k(()=>i.company);x(m,()=>{m.value?a.value={...m.value}:a.value={...b}});const s=k({get(){return i.visible},set(){o("update:visible",!1)}}),p=()=>{o("update:visible",!1)},g=async()=>{if(i.company){const u={address:a.value.address,contact:a.value.contact,id:a.value.id,manager:a.value.manager,name:a.value.name};(await z(u)).code==200&&(V.success("修改成功"),o("success"),o("update:visible"))}else{const u={address:a.value.address,contact:a.value.contact,manager:a.value.manager,name:a.value.name};(await j(u)).code==200&&(V.success("添加成功"),o("success"),o("update:visible"))}};return(u,l)=>{const r=c("el-input"),n=c("el-form-item"),f=c("el-button"),E=c("el-form"),U=c("el-dialog");return D(),B(U,{modelValue:s.value,"onUpdate:modelValue":l[4]||(l[4]=d=>s.value=d),"show-close":!1,width:"600"},{header:t(()=>[y("div",F,$(m.value?"公司编辑":"公司添加"),1)]),default:t(()=>[y("div",null,[e(E,{"label-width":"120"},{default:t(()=>[e(n,{label:"公司名"},{default:t(()=>[e(r,{modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value.name=d)},null,8,["modelValue"])]),_:1}),e(n,{label:"地址"},{default:t(()=>[e(r,{modelValue:a.value.address,"onUpdate:modelValue":l[1]||(l[1]=d=>a.value.address=d)},null,8,["modelValue"])]),_:1}),e(n,{label:"负责人"},{default:t(()=>[e(r,{modelValue:a.value.manager,"onUpdate:modelValue":l[2]||(l[2]=d=>a.value.manager=d)},null,8,["modelValue"])]),_:1}),e(n,{label:"负责人电话"},{default:t(()=>[e(r,{modelValue:a.value.contact,"onUpdate:modelValue":l[3]||(l[3]=d=>a.value.contact=d)},null,8,["modelValue"])]),_:1}),e(n,null,{default:t(()=>[e(f,{type:"primary",onClick:g},{default:t(()=>[v("提交")]),_:1}),e(f,{type:"primary",onClick:p},{default:t(()=>[v("取消")]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}}),R={class:"user-ctrl-page"},q=y("div",{class:"page-header"},"公司管理",-1),G={class:"option-row"},K=h({__name:"CompanyCtrl",setup(C){w({username:"",name:"",phone:""});const _=w([]),i=async()=>{const s=await T();_.value=s.data};i();const o=H({visible:!1,company:null});S();const b=()=>{o.visible=!0,o.company=null},a=s=>{o.visible=!0,o.company=s},m=async s=>{(await A(s.id)).code==200&&(V.success("删除成功"),await i())};return(s,p)=>{const g=c("el-divider"),u=c("el-button"),l=c("el-table-column"),r=c("el-table");return D(),N("div",R,[q,e(g),y("div",G,[e(u,{type:"primary",onClick:b},{default:t(()=>[v("新建公司")]),_:1})]),e(r,{data:_.value,style:{width:"100%"}},{default:t(()=>[e(l,{prop:"name",label:"公司名"}),e(l,{prop:"address",width:"220",label:"地址"}),e(l,{prop:"manager",label:"负责人"}),e(l,{prop:"contact",label:"负责人电话"}),e(l,{label:"操作",width:"180"},{default:t(n=>[e(u,{size:"small",onClick:f=>a(n.row)},{default:t(()=>[v("编辑")]),_:2},1032,["onClick"]),e(u,{size:"small",type:"danger",onClick:f=>m(n.row)},{default:t(()=>[v("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(M,{visible:o.visible,"onUpdate:visible":p[0]||(p[0]=n=>o.visible=n),company:o.company,onSuccess:i},null,8,["visible","company"])])}}});export{K as default};
