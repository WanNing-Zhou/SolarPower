import{d as B,r as g,l as E,w as $,c as z,a,b as n,o as k,f as y,t as L,e,g as b,E as x,z as M,m as P,i as I,u as T,F as j,n as O}from"./index-885010f6.js";import{e as R,u as q,g as A,f as G,h as J}from"./suer-a4f6e5f0.js";const K={class:"my-header"},Q=B({__name:"PointEditDialog",props:{visible:{type:Boolean},companyId:{},data:{}},emits:["update:visible","success"],setup(D,{emit:c}){const p=D,r=c,v={name:"",address:"",manager:"",contact:"",type:"",capacity:""},t=g({...v}),s=E(()=>p.data);$(s,()=>{s.value?t.value={...s.value}:t.value={...v}});const V=E({get(){return p.visible},set(){r("update:visible",!1)}}),C=()=>{r("update:visible",!1)},U=async()=>{p.data?(await q({...t.value,id:s.value.id,companyId:p.companyId})).code==200&&(x.success("修改成功"),r("success"),r("update:visible")):(await R({...t.value,companyId:p.companyId})).code==200&&(x.success("添加成功"),r("success"),r("update:visible"))};return(d,l)=>{const m=n("el-input"),u=n("el-form-item"),f=n("el-form"),w=n("el-button"),S=n("el-dialog");return k(),z(S,{modelValue:V.value,"onUpdate:modelValue":l[6]||(l[6]=o=>V.value=o),"show-close":!1,width:"500"},{header:a(()=>[y("div",K,L(s.value?"站点编辑":"站点添加"),1)]),footer:a(()=>[e(w,{type:"primary",onClick:U},{default:a(()=>[b("提交")]),_:1}),e(w,{type:"primary",onClick:C},{default:a(()=>[b("取消")]),_:1})]),default:a(()=>[y("div",null,[e(f,{"label-width":"120"},{default:a(()=>[e(u,{label:"电站名称"},{default:a(()=>[e(m,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=o=>t.value.name=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"容量"},{default:a(()=>[e(m,{modelValue:t.value.capacity,"onUpdate:modelValue":l[1]||(l[1]=o=>t.value.capacity=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"设备类型"},{default:a(()=>[e(m,{modelValue:t.value.type,"onUpdate:modelValue":l[2]||(l[2]=o=>t.value.type=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"负责人"},{default:a(()=>[e(m,{modelValue:t.value.manager,"onUpdate:modelValue":l[3]||(l[3]=o=>t.value.manager=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"负责人电话"},{default:a(()=>[e(m,{modelValue:t.value.contact,"onUpdate:modelValue":l[4]||(l[4]=o=>t.value.contact=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"电站地址"},{default:a(()=>[e(m,{modelValue:t.value.address,"onUpdate:modelValue":l[5]||(l[5]=o=>t.value.address=o)},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}}),W={class:"user-ctrl-page"},X=y("div",{class:"page-header"},"电站管理",-1),Y={class:"search-row"},Z={class:"option-row"},ae=B({__name:"PointCtrl",setup(D){const c=g(null),p=g([{label:"kakaxi",value:"123"}]),r=async()=>{const d=await A();p.value=d.data.map(l=>({label:l.name,value:l.id}))},v=g([]),t=async()=>{console.log(c.value);const d=await G({companyId:c.value});v.value=d.data};$(c,()=>{t()});const s=M({visible:!1,data:null});T();const V=()=>{s.visible=!0,s.data=null},C=d=>{s.visible=!0,s.data=d},U=async d=>{(await J(d.id)).code==200&&(x.success("删除成功"),await t())};return P(async()=>{await r(),c.value=p.value[0].value}),(d,l)=>{const m=n("el-divider"),u=n("el-col"),f=n("el-row"),w=n("el-option"),S=n("el-select"),o=n("el-form-item"),F=n("el-form"),h=n("el-button"),_=n("el-table-column"),H=n("el-table");return k(),I("div",W,[X,e(m),y("div",Y,[e(F,null,{default:a(()=>[e(f,null,{default:a(()=>[e(u)]),_:1}),e(f,null,{default:a(()=>[e(u,{span:8},{default:a(()=>[e(o,{label:"公司名称"},{default:a(()=>[e(S,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=i=>c.value=i),placeholder:"Select",style:{width:"240px"}},{default:a(()=>[(k(!0),I(j,null,O(p.value,i=>(k(),z(w,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:4})]),_:1}),e(f,{justify:"end"})]),_:1})]),y("div",Z,[e(h,{type:"primary",onClick:V},{default:a(()=>[b("新建站点")]),_:1})]),e(H,{data:v.value,style:{width:"100%"}},{default:a(()=>[e(_,{prop:"name",label:"电站名"}),e(_,{prop:"capacity",label:"容量"}),e(_,{prop:"type",label:"设备类型"}),e(_,{prop:"manager",label:"负责人"}),e(_,{prop:"contact",label:"负责人电话"}),e(_,{prop:"address",width:"220",label:"地址"}),e(_,{label:"操作",width:"180"},{default:a(i=>[e(h,{size:"small",onClick:N=>C(i.row)},{default:a(()=>[b("编辑")]),_:2},1032,["onClick"]),e(h,{size:"small",type:"danger",onClick:N=>U(i.row)},{default:a(()=>[b("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(Q,{visible:s.visible,"onUpdate:visible":l[1]||(l[1]=i=>s.visible=i),onSuccess:t,"company-id":c.value,data:s.data},null,8,["visible","company-id","data"])])}}});export{ae as default};
