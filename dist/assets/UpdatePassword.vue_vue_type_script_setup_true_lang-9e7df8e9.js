import{u as y,a as x}from"./user-5209be3f.js";import{y as k,z as U,E as u,d as B,A as C,r as _,n as N,c as E,a as t,b as d,e as R,f as o,h as T,g as h}from"./index-4243db9d.js";async function z(){(await y()).code==200&&(k.push("/login"),U(),u.success("登出成功"))}const L=B({__name:"UpdatePassword",props:{visible:{type:Boolean}},emits:["update:visible"],setup(i,{emit:v}){const P=i,p=v,V=C({oldPassword:[{min:6,max:32,message:"密码长度应在6-32间"}],newPassword:[{min:6,max:32,message:"密码长度应在6-32间"}],rePassword:[{min:6,max:32,message:"密码长度应在6-32间"}]}),w=_(),f=N({get(){return P.visible},set(n){p("update:visible",n)}}),s=_({oldPassword:"",newPassword:"",rePassword:""}),g=async()=>{var n;(n=w.value)==null||n.validate(async e=>{if(e){const{oldPassword:r,newPassword:a,rePassword:m}=s.value;if(!a||!r){u.warning("密码不能为空");return}if(a!=m){u.warning("新密码两次输入不一致");return}(await x({oldPassword:r,newPassword:a})).code==200&&(u.success("修改成功"),z(),p("update:visible",!1))}else u.warning("表单校验失败, 请检查表单")})};return(n,e)=>{const r=d("el-input"),a=d("el-form-item"),m=d("el-form"),c=d("el-button"),b=d("el-dialog");return R(),E(b,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),title:"修改密码",width:"500"},{footer:t(()=>[o(c,{onClick:g,type:"primary"},{default:t(()=>[T("提交")]),_:1})]),default:t(()=>[h("div",null,[o(m,{ref_key:"formRef",ref:w,model:s.value,rules:V,"label-width":"120"},{default:t(()=>[o(a,{prop:"oldPassword",label:"旧密码"},{default:t(()=>[o(r,{modelValue:s.value.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.oldPassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1}),o(a,{prop:"newPassword",label:"新密码"},{default:t(()=>[o(r,{modelValue:s.value.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.newPassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1}),o(a,{prop:"rePassword",label:"确认密码"},{default:t(()=>[o(r,{modelValue:s.value.rePassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.rePassword=l),"show-password":"",type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}}});export{L as _,z as l};
